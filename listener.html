<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MMG Radio</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* Reset and base */
  * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Montserrat', sans-serif; }
  body { background: #0b0b0b; color: #fff; }

  header { 
    background: linear-gradient(90deg, #6e00ff, #b100ff);
    padding: 20px;
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: 1px;
  }

  main { padding: 20px; max-width: 1000px; margin: 0 auto; }

  .player { display: flex; flex-direction: column; align-items: center; margin-bottom: 40px; }
  .album-art { width: 250px; height: 250px; border-radius: 50%; overflow: hidden; margin-bottom: 20px; box-shadow: 0 0 20px rgba(177,0,255,0.5); }
  .album-art img { width: 100%; height: 100%; object-fit: cover; }
  .song-info { text-align: center; margin-bottom: 20px; }
  .song-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 5px; }
  .song-artist { font-size: 1rem; color: #ccc; }

  .play-btn { background: #b100ff; border: none; border-radius: 50%; width: 70px; height: 70px; color: #fff; font-size: 1.5rem; cursor: pointer; transition: transform 0.2s; }
  .play-btn:hover { transform: scale(1.1); }

  .recent-tracks { margin-top: 40px; }
  .recent-tracks h2 { margin-bottom: 20px; font-size: 1.5rem; }
  .track { display: flex; align-items: center; margin-bottom: 15px; }
  .track-art { width: 60px; height: 60px; border-radius: 8px; overflow: hidden; margin-right: 15px; }
  .track-art img { width: 100%; height: 100%; object-fit: cover; }
  .track-info { display: flex; flex-direction: column; }
  .track-title { font-weight: 600; }
  .track-artist { font-size: 0.9rem; color: #aaa; }
</style>
</head>
<body>

<header>MMG Radio</header>

<main>
  <div class="player">
    <div class="album-art"><img id="album-art" src="" alt="Album Art"></div>
    <div class="song-info">
      <div class="song-title" id="song-title">Loading...</div>
      <div class="song-artist" id="song-artist"></div>
    </div>
    <button class="play-btn" id="play-btn">▶</button>
  </div>

  <div class="recent-tracks">
    <h2>Recently Played</h2>
    <div id="recent-tracks-list"></div>
  </div>
</main>

<script>
  const API_URL = 'https://api.typicalmedia.com/v1/station/your-station-id'; // Replace with your Typical Media station ID
  const albumArt = document.getElementById('album-art');
  const songTitle = document.getElementById('song-title');
  const songArtist = document.getElementById('song-artist');
  const recentTracksList = document.getElementById('recent-tracks-list');
  const playBtn = document.getElementById('play-btn');

  let audio = new Audio();

  async function fetchNowPlaying() {
    try {
      const response = await fetch(`${API_URL}/nowplaying`);
      const data = await response.json();
      albumArt.src = data.current.albumArt || '';
      songTitle.textContent = data.current.title || 'Unknown Title';
      songArtist.textContent = data.current.artist || 'Unknown Artist';
      audio.src = data.current.streamUrl;
    } catch(err) {
      console.error('Error fetching now playing:', err);
      songTitle.textContent = 'Error loading song';
    }
  }

  async function fetchRecentTracks() {
    try {
      const response = await fetch(`${API_URL}/recent`);
      const data = await response.json();
      recentTracksList.innerHTML = '';
      data.recent.forEach(track => {
        const trackEl = document.createElement('div');
        trackEl.classList.add('track');
        trackEl.innerHTML = `
          <div class="track-art"><img src="${track.albumArt}" alt="${track.title}"></div>
          <div class="track-info">
            <div class="track-title">${track.title}</div>
            <div class="track-artist">${track.artist}</div>
          </div>
        `;
        recentTracksList.appendChild(trackEl);
      });
    } catch(err) {
      console.error('Error fetching recent tracks:', err);
      recentTracksList.innerHTML = '<p>Error loading recent tracks.</p>';
    }
  }

  playBtn.addEventListener('click', () => {
    if(audio.paused) {
      audio.play();
      playBtn.textContent = '⏸';
    } else {
      audio.pause();
      playBtn.textContent = '▶';
    }
  });

  // Auto-refresh every 30 seconds
  fetchNowPlaying();
  fetchRecentTracks();
  setInterval(fetchNowPlaying, 30000);
  setInterval(fetchRecentTracks, 30000);
</script>

</body>
</html>
