<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MMG Radio</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
  body { background: #121212; color: #fff; font-family: sans-serif; }
  .card { background: #1e1e1e; color: #fff; margin: 20px auto; max-width: 600px; border-radius: 1rem; }
  .now-playing-art img { width: 100%; height: auto; border-radius: 0.5rem; }
  .radio-controls { display: flex; align-items: center; justify-content: space-between; margin-top: 15px; }
  .progress-bar { background-color: #ff5e5e; }
  a { color: #ff5e5e; text-decoration: none; }
  a:hover { text-decoration: underline; }
</style>
</head>
<body class="page-minimal page-station-public-player station-mmg_radio">

<div id="page-wrapper">
  <main id="main">
    <div id="public-radio-player" class="vue-component">
      <div class="public-page">
        <div class="card">
          <div class="card-body">
            <h2 class="card-title mb-3">MMG Radio</h2>
            <div class="stations nowplaying">
              <div class="radio-player-widget">
                <div class="now-playing-details">
                  <div class="now-playing-art">
                    <a href="#" class="album-art" target="_blank" title="Enlarge Album Art">
                      <img class="album_art" src="" alt="Album Art">
                    </a>
                  </div>
                  <div class="now-playing-main">
                    <div>
                      <h4 class="now-playing-title">Loading...</h4>
                      <h5 class="now-playing-artist"></h5>
                    </div>
                    <div class="time-display">
                      <div class="time-display-played text-secondary">00:00</div>
                      <div class="time-display-progress">
                        <div class="progress h-5">
                          <div class="progress-bar bg-secondary" role="progressbar" style="width: 0%;"></div>
                        </div>
                      </div>
                      <div class="time-display-total text-secondary">00:00</div>
                    </div>
                  </div>
                </div>
                <hr class="my-2">
                <div class="radio-controls">
                  <button type="button" class="btn p-0 radio-control-play-button btn-xl">Play</button>
                  <div class="radio-control-volume d-flex align-items-center">
                    <div class="flex-fill radio-control-volume-slider">
                      <input type="range" title="Volume" class="form-range" min="0" max="100" step="1">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body buttons pt-0">
            <a class="btn btn-link text-secondary" href="#"><span>Song History</span></a>
            <a class="btn btn-link text-secondary" href="#"><span>Request Song</span></a>
            <a class="btn btn-link text-secondary" href="/public/mmg_radio/playlist.pls"><span>Playlist</span></a>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@3.4.0/dist/vue.global.prod.js"></script>

<script>
// Example: Replace these API endpoints with your Typical Media station API
const STATION_ID = "mmg_radio";
const API_BASE = "https://azura.typicalmedia.net/api/station/";

function fetchNowPlaying() {
  fetch(`${API_BASE}${STATION_ID}/nowplaying`)
    .then(res => res.json())
    .then(data => {
      document.querySelector('.now-playing-title').textContent = data.song.title;
      document.querySelector('.now-playing-artist').textContent = data.song.artist;
      const img = document.querySelector('.album_art');
      img.src = data.song.art || '';
      img.parentElement.href = data.song.art || '#';
      document.querySelector('.time-display-total').textContent = data.song.length || '00:00';
    });
}

// Update now playing every 5 seconds
fetchNowPlaying();
setInterval(fetchNowPlaying, 5000);

// Play/pause functionality
const playButton = document.querySelector('.radio-control-play-button');
let audio = new Audio('/public/mmg_radio/playlist.pls');
audio.autoplay = false;

playButton.addEventListener('click', () => {
  if (audio.paused) {
    audio.play();
    playButton.textContent = "Pause";
  } else {
    audio.pause();
    playButton.textContent = "Play";
  }
});

// Volume control
document.querySelector('.form-range').addEventListener('input', e => {
  audio.volume = e.target.value / 100;
});
</script>

</body>
</html>
